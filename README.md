# Cesium Spatial ID Visualizer

このプロジェクトは、Cesium を用いてバイナリ形式の spatial ID を可視化する Web アプリケーションです。CSV ファイルから binaryId 列を読み込み、各オブジェクトの元データ（標高、経度、緯度、時刻）を復元し、Cesium 上に描画します。

## ファイル構成

    Cesiumview/
    ├── index.html                // エントリーポイント（HTML）
    └── src/
        ├── config.js             // Cesium のアクセストークン設定
        ├── calculate_spatial.js  // spatial ID の計算・変換関数群
        ├── viewer.js             // Cesium Viewer の初期化
        ├── ui.js                 // ファイル選択、情報表示、検索パネルの生成
        ├── utils.js              // 補助関数（computeAxisBounds）
        ├── csvProcessor.js       // CSV 読込、解析、エンティティ描画、検索処理
        └── app.js                // 各モジュールの初期化

## セットアップ

1. 本プロジェクトをローカルにクローンまたはダウンロードしてください。

2. Cesiumトークンを取得し、トークンをconfig_example.jsに書き込んでください。ファイル名をconfig.jsに名前を変更してください

3. ターミナルで下記のコマンドを実行し、ローカルサーバーを起動します。

   ```bash
   npx http-server .

   ```
4. ブラウザで下記の URL にアクセスしてください。

    (http://127.0.0.1:8080)
## 使い方
1. ブラウザ上で表示される画面左上にある「ファイル選択」ボタンから、binaryId の CSV ファイルを選択してください。
- 例: data/Sample/test.csv

2. CSV ファイルを読み込むと、各行の binaryId から各オブジェクトの元データが復元され、Cesium 上に描画されます。

3. 右上の検索パネルに binaryId を入力して、対応するオブジェクトの位置にカメラを移動させることも可能です。

## 空間IDの仕様
- Headerが各軸のズームレベルを表します。(10100=ZoomLv.20)
- 時空間IDのcsvファイルの処理が終了すると、最後に読み込んだIDの座標にカメラが移動します。
- 移動後に何も表示されない場合は、画面下部の時間バーを変更してください。IDの占有時間に合わせると、IDの占有領域が立方体で表示されます。
   ```bash
   # この例では視認性確保のためスラッシュで区切られていますが、Cesiumに読み込ませるIDはスラッシュがありません。
   Header_f/Header_x/Header_y/Header_t/str_f/str_x_str_y/time
   10110/10110/10110/10110/0000000000000000000000/1110001101110010111010/0110001100111101101100/1100111111111000101000
   ```
- このIDの構成は、f,x,y,t軸における各ヘッダーとその値になります。ヘッダーは各値5bitの20bit固定で、それぞれの値の桁数を示しています。
   ```bash
   101101011010110101100000000000000000000000111000110111001011101001100011001111011011001100111111111000101000
   ```